var doc=App.ActiveDoc;
var text = doc.Text

var m = text.match(/\[.*?\]\(http.*?\)/g);
if (m) {
	var footer = "";
	for (var i = 0; i < m.length; i++ ) {
		//OutputWindow.OutputLine(i + ' -> ' + m[i]);
		
		// 替换原来的
		text = text.replace(m[i], m[i].replace(/\(http.*?\)/, '[' + i + ']'));

		footer += '[' + i + ']: ' + m[i].match(/\((http.*?)\)/)[1] + '\n';
	}

	doc.Text = text + '\n\n' + footer;
}
